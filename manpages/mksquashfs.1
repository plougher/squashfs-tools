.\" DO NOT MODIFY THIS FILE!  It was generated by help2man 1.49.3.
.TH MKSQUASHFS "1" "January 2025" "mksquashfs version 4.6.1-0a6c112" "User Commands"
.SH NAME
mksquashfs - tool to create and append to squashfs filesystems
.SH SYNOPSIS
.B mksquashfs
\fI\,source1 source2 \/\fR...  \fI\,FILESYSTEM \/\fR[\fI\,OPTIONS\/\fR] [\fI\,-e list of exclude dirs/files\/\fR]
.SH DESCRIPTION
Squashfs is a highly compressed read-only filesystem for Linux.
It uses either gzip/xz/lzo/lz4/zstd compression to compress both files, inodes
and directories.  Inodes in the system are very small and all blocks are
packed to minimise data overhead. Block sizes greater than 4K are supported
up to a maximum of 1Mbytes (default block size 128K).

Squashfs is intended for general read-only filesystem use, for archival
use (i.e. in cases where a .tar.gz file may be used), and in constrained
block device/memory systems (e.g. embedded systems) where low overhead is
needed.
.SH OPTIONS
.SS "Filesystem compression options:"
.TP
\fB\-b\fR BLOCK\-SIZE
set data block to BLOCK\-SIZE.  Default 128 Kbytes. Optionally a suffix of K, KB, Kbytes or M, MB, Mbytes can be given to specify Kbytes or Mbytes respectively.
.TP
\fB\-comp\fR COMP
select COMP compression.  Run \fB\-help\-comp\fR COMP to get compressor options for COMP, or ALL for all the compressors. Compressors available: gzip (default), lzo, lz4, xz, zstd.
.TP
\fB\-noI\fR
do not compress inode table.
.TP
\fB\-noId\fR
do not compress the uid/gid table (implied by \fB\-noI\fR).
.TP
\fB\-noD\fR
do not compress data blocks.
.TP
\fB\-noF\fR
do not compress fragment blocks.
.TP
\fB\-noX\fR
do not compress extended attributes.
.TP
\fB\-no\-compression\fR
do not compress any of the data or metadata.  This is equivalent to specifying \fB\-noI\fR \fB\-noD\fR \fB\-noF\fR and \fB\-noX\fR.
.SS "Filesystem build options:"
.TP
\fB\-tar\fR
read uncompressed tar file from standard in (stdin).
.TP
\fB\-no\-strip\fR
act like tar, and do not strip leading directories from source files.
.TP
\fB\-tarstyle\fR
alternative name for \fB\-no\-strip\fR.
.TP
\fB\-cpiostyle\fR
act like cpio, and read file pathnames from standard in (stdin).
.TP
\fB\-cpiostyle0\fR
like \fB\-cpiostyle\fR, but filenames are null terminated.  Can be used with find \fB\-print0\fR action.
.TP
\fB\-reproducible\fR
build filesystems that are reproducible (default).
.TP
\fB\-not\-reproducible\fR
build filesystems that are not reproducible.
.TP
\fB\-mkfs\-time\fR TIME
set filesystem creation timestamp to TIME. TIME can be an unsigned 32\-bit int indicating seconds since the epoch (1970\-01\-01) or a string value which is passed to the "date" command to parse. Any string value which the date command recognises can be used such as "now", "last week", or "Wed Feb 15 21:02:39 GMT 2023".
.TP
\fB\-all\-time\fR TIME
set all file and directory timestamps to TIME. TIME can be an unsigned 32\-bit int indicating seconds since the epoch (1970\-01\-01) or a string value which is passed to the "date" command to parse. Any string value which the date command recognises can be used such as "now", "last week", or "Wed Feb 15 21:02:39 GMT 2023".
.TP
\fB\-root\-time\fR TIME
set root directory time to TIME. TIME can be an unsigned 32\-bit int indicating seconds since the epoch (1970\-01\-01) or a string value which is passed to the "date" command to parse. Any string value which the date command recognises can be used such as "now", "last week", or "Wed Feb 15 21:02:39 GMT 2023".
.TP
\fB\-root\-mode\fR MODE
set root directory permissions to MODE.  MODE can be symbolic or octal (see section Symbolic mode specification).  Default root mode is ugo=rwx or 0777 octal.
.TP
\fB\-root\-uid\fR VALUE
set root directory owner to specified VALUE, VALUE can be either an integer uid or user name.
.TP
\fB\-root\-gid\fR VALUE
set root directory group to specified VALUE, VALUE can be either an integer gid or group name.
.TP
\fB\-all\-root\fR
make all files and directories owned by root.
.TP
\fB\-force\-file\-mode\fR MODE
set all file (non\-directory) permissions to MODE. MODE can be symbolic or octal (see section Symbolic mode specification).
.TP
\fB\-force\-dir\-mode\fR MODE
set all directory permissions to MODE.  MODE can be symbolic or octal (see section Symbolic mode specification).
.TP
\fB\-force\-uid\fR VALUE
set all file and directory uids to specified VALUE, VALUE can be either an integer uid or user name.
.TP
\fB\-force\-gid\fR VALUE
set all file and directory gids to specified VALUE, VALUE can be either an integer gid or group name.
.TP
\fB\-pseudo\-override\fR
make pseudo file uids and gids override \fB\-all\-root\fR, \fB\-force\-uid\fR and \fB\-force\-gid\fR options.
.TP
\fB\-no\-exports\fR
do not make filesystem exportable via NFS (\fB\-tar\fR default).
.TP
\fB\-exports\fR
make filesystem exportable via NFS (default).
.TP
\fB\-no\-sparse\fR
do not detect sparse files.
.TP
\fB\-no\-tailends\fR
do not pack tail ends into fragments (default).
.TP
\fB\-tailends\fR
pack tail ends into fragments.
.TP
\fB\-no\-fragments\fR
do not use fragments.
.TP
\fB\-no\-duplicates\fR
do not perform duplicate checking.
.TP
\fB\-no\-hardlinks\fR
do not hardlink files, instead store duplicates.
.TP
\fB\-keep\-as\-directory\fR
if one source directory is specified, create a root directory containing that directory, rather than the contents of the directory.
.SS "Filesystem filter options:"
.TP
\fB\-p\fR PSEUDO\-DEFINITION
add pseudo file definition.  The definition should be quoted.  See section "Pseudo file definition format" later for format details.
.TP
\fB\-pd\fR "d mode uid gid"
specify a default pseudo directory which will be used in pseudo definitions if a directory in the pathname does not exist.  This also allows pseudo definitions to be specified without specifying all the directories in the pathname.  The definition should be quoted.
.TP
\fB\-pd\fR "D time mode uid gid"
specify a default pseudo directory which will be used in pseudo definitions if a directory in the pathname does not exist.  The D type also allows a timestamp to be specified in addition to mode, uid and gid.
.TP
\fB\-pf\fR PSEUDO\-FILE
add list of pseudo file definitions from PSEUDO\-FILE, use \- for stdin.  Pseudo file definitions should not be quoted.
.TP
\fB\-sort\fR SORT\-FILE
sort files according to priorities in SORT\-FILE.  One file or dir with priority per line.  Priority \fB\-32768\fR to 32767, default priority 0.
.TP
\fB\-ef\fR EXCLUDE\-FILE
list of exclude dirs/files.  One per line.
.TP
\fB\-wildcards\fR
allow extended shell wildcards (globbing) to be used in exclude dirs/files.
.TP
\fB\-regex\fR
allow POSIX regular expressions to be used in exclude dirs/files.
.TP
\fB\-max\-depth\fR LEVELS
descend at most LEVELS of directories when scanning filesystem.
.TP
\fB\-one\-file\-system\fR
do not cross filesystem boundaries.  If a directory crosses the boundary, create an empty directory for each mount point.  If a file crosses the boundary ignore it.
.TP
\fB\-one\-file\-system\-x\fR
do not cross filesystem boundaries. Like \fB\-one\-file\-system\fR option except directories are also ignored if they cross the boundary.
.SS "Filesystem extended attribute (xattrs) options:"
.TP
\fB\-no\-xattrs\fR
do not store extended attributes.
.TP
\fB\-xattrs\fR
store extended attributes (default).
.TP
\fB\-xattrs\-exclude\fR REGEX
exclude any xattr names matching REGEX.  REGEX is a POSIX regular expression, e.g. \fB\-xattrs\-exclude\fR '^user.' excludes xattrs from the user namespace.
.TP
\fB\-xattrs\-include\fR REGEX
include any xattr names matching REGEX.  REGEX is a POSIX regular expression, e.g. \fB\-xattrs\-include\fR '^user.' includes xattrs from the user namespace.
.TP
\fB\-xattrs\-add\fR NAME=VAL
add the xattr NAME with VAL to files.  If an user xattr it will be added to regular files and directories (see man 7 xattr).  Otherwise it will be added to all files.  VAL by default will be treated as binary (i.e. an uninterpreted byte sequence), but it can be prefixed with 0s, where it will be treated as base64 encoded, or prefixed with 0x, where val will be treated as hexadecimal.  Additionally it can be prefixed with 0t where this encoding is similar to binary encoding, except backslashes are specially treated, and a backslash followed by 3 octal digits can be used to encode any ASCII character, which obviously can be used to encode control codes.  The option can be repeated multiple times to add multiple xattrs.
.SS "Mksquashfs runtime options:"
.TP
\fB\-version\fR
print version, licence and copyright message.
.TP
\fB\-exit\-on\-error\fR
treat normally ignored errors as fatal.
.TP
\fB\-quiet\fR
no verbose output.
.TP
\fB\-info\fR
print files written to filesystem to stdout.  This automatically disables the progress bar.  See \fB\-info\-file\fR to output to file without disabling the progress bar.
.TP
\fB\-info\-file\fR FILE
print files written to filesystem to file FILE.  This does not disable the progress bar.
.TP
\fB\-no\-progress\fR
do not display the progress bar.
.TP
\fB\-progress\fR
display progress bar when using the \fB\-info\fR option.
.TP
\fB\-percentage\fR
display a percentage rather than the full progress bar. Can be used with dialog \fB\-\-gauge\fR etc.
.TP
\fB\-throttle\fR PERCENTAGE
throttle the I/O input rate by the given percentage. This can be used to reduce the I/O and CPU consumption of Mksquashfs.
.TP
\fB\-limit\fR PERCENTAGE
limit the I/O input rate to the given percentage.  This can be used to reduce the I/O and CPU consumption of Mksquashfs (alternative to \fB\-throttle\fR).
.TP
\fB\-processors\fR NUMBER
use NUMBER processors.  By default will use number of processors available.
.TP
\fB\-mem\fR SIZE
use SIZE physical memory for caches.  Use K, M or G to specify Kbytes, Mbytes or Gbytes respectively.
.TP
\fB\-mem\-percent\fR PERCENT
use PERCENT physical memory for caches.  Default 25%.
.TP
\fB\-mem\-default\fR
print default memory usage in Mbytes.
.SS "Filesystem append options:"
.TP
\fB\-noappend\fR
do not append to existing filesystem.
.TP
\fB\-root\-becomes\fR NAME
when appending source files/directories, make the original root become a subdirectory in the new root called NAME, rather than adding the new source items to the original root.
.TP
\fB\-no\-recovery\fR
do not generate a recovery file.
.TP
\fB\-recovery\-path\fR NAME
use NAME as the directory to store the recovery file.
.TP
\fB\-recover\fR NAME
recover filesystem data using recovery file NAME.
.SS "Filesystem actions options:"
.TP
\fB\-action\fR ACTION@EXPRESSION
evaluate EXPRESSION on every file and directory, and execute ACTION if it returns TRUE.
.TP
\fB\-log\-action\fR ACTION@EXPRESSION
as above, but log expression evaluation results and actions performed.
.TP
\fB\-true\-action\fR ACTION@EXPRESSION
as above, but only log expressions which return TRUE.
.TP
\fB\-false\-action\fR ACTION@EXPRESSION
as above, but only log expressions which return FALSE.
.TP
\fB\-action\-file\fR FILE
as action, but read actions from FILE.
.TP
\fB\-log\-action\-file\fR FILE
as \fB\-log\-action\fR, but read actions from FILE.
.TP
\fB\-true\-action\-file\fR FILE
as \fB\-true\-action\fR, but read actions from FILE.
.TP
\fB\-false\-action\-file\fR FILE
as \fB\-false\-action\fR, but read actions from FILE.
.SS "Tar file only options:"
.TP
\fB\-default\-mode\fR MODE
tar files often do not store permissions for intermediate directories.  This option sets the default directory permissions to MODE.  MODE can be symbolic or octal (see section Symbolic mode specification). Default mode is u=rwx,go=rx or 0755 octal.  This also sets the root directory mode.
.TP
\fB\-default\-uid\fR VALUE
tar files often do not store uids for intermediate directories.  This option sets the default directory owner to VALUE, rather than the user running Mksquashfs.  VALUE can be either an integer uid or user name.  This also sets the root directory uid.
.TP
\fB\-default\-gid\fR VALUE
tar files often do not store gids for intermediate directories.  This option sets the default directory group to VALUE, rather than the group of the user running Mksquashfs.  VALUE can be either an integer uid or group name.  This also sets the root directory gid.
.TP
\fB\-ignore\-zeros\fR
allow tar files to be concatenated together and fed to Mksquashfs.  Normally a tarfile has two consecutive 512 byte blocks filled with zeros which means EOF and Mksquashfs will stop reading after the first tar file on encountering them. This option makes Mksquashfs ignore the zero filled blocks.
.SS "Expert options (these may make the filesystem unmountable):"
.TP
\fB\-nopad\fR
do not pad filesystem to a multiple of 4K.
.TP
\fB\-offset\fR OFFSET
skip OFFSET bytes at the beginning of FILESYSTEM. Optionally a suffix of K, M or G can be given to specify Kbytes, Mbytes or Gbytes respectively.  Default 0 bytes.
.TP
\fB\-o\fR OFFSET
synonym for \fB\-offset\fR.
.SS "Help options:"
.TP
\fB\-help\fR
print help summary information to stdout.
.TP
\fB\-help\-option\fR REGEX
print the help information for Mksquashfs options matching REGEX to stdout.
.TP
\fB\-help\-section\fR SECTION print the help information for section SECTION to
pager (or stdout if not a terminal).  Use "sections" or "h" as section name to get a list of sections and their names.
.TP
\fB\-help\-comp\fR COMP
print compressor options for compressor COMP.  Use ALL to get compressor options for all the compressors.
.TP
\fB\-help\-all\fR
print help information for all Mksquashfs options and sections to pager (or stdout if not a terminal).
.TP
\fB\-Xhelp\fR
print compressor options for selected compressor.
.TP
\fB\-h\fR
shorthand alternative to \fB\-help\fR.
.TP
\fB\-ho\fR REGEX
shorthand alternative to \fB\-help\-option\fR.
.TP
\fB\-hs\fR SECTION
shorthand alternative to \fB\-help\-section\fR.
.TP
\fB\-ha\fR
shorthand alternative to \fB\-help\-all\fR.
.SS "Miscellaneous options:"
.TP
\fB\-fstime\fR TIME
alternative name for \fB\-mkfs\-time\fR.
.TP
\fB\-always\-use\-fragments\fR
alternative name for \fB\-tailends\fR.
.TP
\fB\-root\-owned\fR
alternative name for \fB\-all\-root\fR.
.TP
\fB\-noInodeCompression\fR
alternative name for \fB\-noI\fR.
.TP
\fB\-noIdTableCompression\fR
alternative name for \fB\-noId\fR.
.TP
\fB\-noDataCompression\fR
alternative name for \fB\-noD\fR.
.TP
\fB\-noFragmentCompression\fR
alternative name for \fB\-noF\fR.
.TP
\fB\-noXattrCompression\fR
alternative name for \fB\-noX\fR.
.TP
\fB\-pseudo\-dir\fR
alternative name for \fB\-pd\fR.
.SH "PSEUDO FILE DEFINITION FORMAT"
.TP
\fB\-p\fR "filename d mode uid gid"
create a directory.
.TP
\fB\-p\fR "filename m mode uid gid"
modify filename.
.TP
\fB\-p\fR "filename b mode uid gid major minor"
create a block device.
.TP
\fB\-p\fR "filename c mode uid gid major minor"
create a character device.
.TP
\fB\-p\fR "filename f mode uid gid command"
create file from stdout of command.
.TP
\fB\-p\fR "filename s mode uid gid symlink"
create a symbolic link.
.TP
\fB\-p\fR "filename i mode uid gid [s|f]"
create a socket (s) or FIFO (f).
.TP
\fB\-p\fR "filename x name=val"
create an extended attribute.
.TP
\fB\-p\fR "filename h linkname"
create a hard\-link to linkname, follows symlinks.
.TP
\fB\-p\fR "filename l linkname"
create a hard\-link to linkname.
.TP
\fB\-p\fR "filename L pseudo_filename"
same, but link to pseudo file.
.TP
\fB\-p\fR "filename D time mode uid gid"
create a directory with timestamp time.
.TP
\fB\-p\fR "filename M time mode uid gid"
modify a file with timestamp time.
.TP
\fB\-p\fR "filename B time mode uid gid major minor"
create block device with timestamp time.
.TP
\fB\-p\fR "filename C time mode uid gid major minor"
create char device with timestamp time.
.TP
\fB\-p\fR "filename F time mode uid gid command"
create file with timestamp time.
.TP
\fB\-p\fR "filename S time mode uid gid symlink"
create symlink with timestamp time.
.TP
\fB\-p\fR "filename I time mode uid gid [s|f]"
create socket/fifo with timestamp time.
.SH "SYMBOLIC MODE SPECIFICATION"
The symbolic mode is of the format [ugoa]*[[+\-=]PERMS]+.  PERMS = [rwxXst]+ or
[ugo], and the sequence can be repeated separated with commas.
.PP
A combination of the letters ugoa specify which permission bits will be
affected, u means user, g means group, o means other, and a means all or ugo.
.PP
The next letter is +, \- or =.  The letter + means add to the existing permission
bits, \- means remove the bits from the existing permission bits, and = means set
the permission bits.
.PP
The permission bits (PERMS) are a combination of [rwxXst] which
sets/adds/removes those bits for the specified ugoa combination, r means read, w
means write and x means execute for files or search for directories.  X has a
special meaning, if the file is a directory it is equivalent to x or search, but
if it is a non\-directory, it only takes effect if execute is already set for
user, group or other.  The s flag sets user or group ID on execution, and the t
flag on a directory sets restricted deletion, or historically made the file
sticky if a non\-directory.
.PP
The permission bits can also be u, g or o, which takes the permission bits from
the user, group or other of the file respectively.
.SH "EXIT STATUS"
.TP
0
Mksquashfs successfully generated a filesystem.
.TP
1
Fatal errors occurred, Mksquashfs aborted and did not generate a
filesystem (or update if appending).
.SH "COMPRESSORS AVAILABLE AND COMPRESSOR SPECIFIC OPTIONS"
.SS "gzip (default):"
.TP
\fB\-Xcompression\-level\fR COMPRESSION\-LEVEL
COMPRESSION\-LEVEL should be 1 .. 9 (default 9).
.TP
\fB\-Xwindow\-size\fR WINDOW\-SIZE
WINDOW\-SIZE should be 8 .. 15 (default 15).
.TP
\fB\-Xstrategy\fR strategy1,strategy2,...,strategyN
Compress using strategy1,strategy2,...,strategyN in turn and choose the best compression.  Available strategies: default, filtered, huffman_only, run_length_encoded and fixed.
.SS "lzo:"
.TP
\fB\-Xalgorithm\fR ALGORITHM
Where ALGORITHM is one of: lzo1x_1, lzo1x_1_11, lzo1x_1_12, lzo1x_1_15, lzo1x_999 (default).
.TP
\fB\-Xcompression\-level\fR COMPRESSION\-LEVEL
COMPRESSION\-LEVEL should be 1 .. 9 (default 8).  Only applies to lzo1x_999 algorithm.
.SS "lz4:"
.TP
\fB\-Xhc\fR
Compress using LZ4 High Compression.
.SS "xz:"
.TP
\fB\-Xbcj\fR filter1,filter2,...,filterN
Compress using filter1,filter2,...,filterN in turn (in addition to no filter), and choose the best compression.  Available filters: x86, arm, armthumb, arm64, powerpc, sparc, ia64, riscv.
.TP
\fB\-Xdict\-size\fR DICT\-SIZE
Use DICT\-SIZE as the XZ dictionary size.  The dictionary size can be specified as a percentage of the block size, or as an absolute value.  The dictionary size must be less than or equal to the block size and 8192 bytes or larger.  It must also be storable in the xz header as either 2^n or as 2^n+2^(n+1). Example dict\-sizes are 75%, 50%, 37.5%, 25%, or 32K, 16K, 8K etc.
.SS "zstd:"
.TP
\fB\-Xcompression\-level\fR COMPRESSION\-LEVEL
COMPRESSION\-LEVEL should be 1 .. 22 (default 15)
.SH ENVIRONMENT
.TP
SOURCE_DATE_EPOCH
If set, this is used as the filesystem creation timestamp.  Also any file timestamps which are after SOURCE_DATE_EPOCH will be clamped to SOURCE_DATE_EPOCH. See https://reproducible\-builds.org/docs/source\-date\-epoch/ for more information.
.TP
PAGER
If set, this is used as the name of the program used to display the help text.  The value can be a simple command or a pathname.  The default is \fI\,/usr/bin/pager\/\fP.
.SH EXAMPLES
.TP
mksquashfs DIRECTORY IMAGE.SQFS
Create a Squashfs filesystem from the contents of DIRECTORY, writing the output
to IMAGE.SQFS.  Mksquashfs will use the default compressor (normally gzip), and
a block size of 128 Kbytes.
.TP
mksquashfs DIRECTORY FILE1 FILE2 IMAGE.SQFS
Create a Squashfs filesystem containing DIRECTORY and FILE1 and FILE2.  If
multiple sources are specified on the command line they will be combined into
a single directory.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -b 1M -comp zstd
Use a block size of 1 Mbyte and Zstandard compression to create the filesystem. 
.TP
mksquashfs DIRECTORY IMAGE.SQFS -all-time now
Set all file and directory timestamps to "now" (current time) in the filesystem.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -force-uid phillip -force-gid phillip
Make all files and directories in the filesystem owned by "phillip".
.TP
mksquashfs DIRECTORY IMAGE.SQFS -force-file-mode ugo+r,go-w
Make all files readable by everyone, but only writable by user, all other
permission bits are unaffected.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -e file1 file2
Exclude file1 and file2 from DIRECTORY when creating filesystem.  No wildcard
matching of files.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -wildcards -e "*.gz"
Exclude anything in DIRECTORY which matches the wildcard pattern "*.gz".
.TP
mksquashfs DIRECTORY IMAGE.SQFS -wildcards -e "... *.gz"
Exclude files which match the wildcard pattern "*.gz" anywhere within DIRECTORY
and its sub-directories.  The initial "..." indicates the wildcard pattern is
"non-anchored" and will match anywhere.
.PP
Note: when passing wildcarded names to Mksquashfs, they should be quoted (as in
the above examples), to ensure that they are not processed by the shell.

.SS Using pseudo file definitions
.TP
mksquashfs DIRECTORY IMAGE.SQFS -p "build_dir d 0644 0 0"
Create a directory called "build_dir" in the output filesystem.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -p "version.txt l /tmp/build/version"
Create a reference called "version.txt" to a file outside DIRECTORY, which acts
as if the file "/tmp/build/version" was copied or hard-linked into DIRECTORY
before calling Mksquashfs.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -p "date.txt f 0644 0 0 date"
Create a file called "date.txt" which holds the output (stdout) from running
the "date" command.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -p "\\"hello world\\" f 0644 0 0 date"
As above, but, showing that filenames can have spaces, if they are quoted.
The quotes need to be blackslashed to protect them from the shell.
.TP
mksquashfs - IMAGE.SQFS -p "input f 0644 root root dd if=/dev/sda1 bs=1024" -p "/ d 0644 0 0"
Create a file containing the contents of partition /dev/sda1".  Ordinarily
Mksquashfs given a device, fifo, or named socket will place that special file
within the Squashfs filesystem, the above allows input from these special files
to be captured and placed in the Squashfs filesystem.   Note there are no other
sources than the pseudo file, and so the command line source is "-".  If there
are no other sources than pseudo files, the root (/) directory must be defined
too, as seen in this example.
.TP
unsquashfs -pf - IMAGE.SQFS | mksquashfs - NEW.SQFS -pf -
Transcode IMAGE.SQFS to NEW.SQFS by piping the pseudo file output from
Unsquashfs to Mksquashfs using stdout and stdin.  This can convert from
earlier Squashfs filesystems or change compression algorithm, block size etc.
without needing to unpack into an intermediate directory or file.
.PP
Note: pseudo file definitions should be quoted (as in the above examples), to
ensure that they are passed to Mksquashfs as a single argument, and to ensure
that they are not processed by the shell.

.SS Using extended attribute options
.TP
mksquashfs DIRECTORY IMAGE.SQFS -no-xattrs
Do not store any extended attributes in the Squashfs filesystem.  Any extended
attributes in the source files will be ignored.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -xattrs-include "^user."
Filter the extended attributes in the source files, and only store extended
attributes in the user namespace in the Squashfs filesystem.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -xattrs-exclude "^user."
Filter the extended attributes in the source files, and don't store any
extended attributes in the user namespace in the Squashfs filesystem.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -xattrs-add "user.comment=hello world"
Add the extended attribute called "user.comment" with the content "hello world"
to all files and directories in the Squashfs filesystem.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -xattrs-add "user.comment=0thello world\\012"
Add the extended attribute called "user.comment" to all files and directories,
but in this case the contents of the extended attribute will be "hello world"
with a trailing newline character (012 octal).
.TP
mksquashfs DIRECTORY IMAGE.SQFS -xattrs-add "user.comment=0saGVsbG8gd29ybGQ="
Add the extended attribute called "user.comment" to all files and directories,
where the value is given in base64 encoding, representing "hello world".
.TP
mksquashfs DIRECTORY IMAGE.SQFS -action "-xattrs-include(^user.) @ type(f)"
Filter the extended attributes but only in regular files (type f), and only
store extended attributes in the user namespace.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -p "hello_world x user.comment=0tsalve mundi\\012"
Add the extended attribute called "user.comment" to the file called
"hello_world", with the contents of the extended attribute being "salve mundi"
with a trailing newline character (012 octal).

.SS Using Actions to not compress, change attributes etc.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -action "uncompressed @ (name(*.jpg) || name(*.mpg) ) || (name(*.img) && filesize(+1G))"
Specify that any files matching the wildcards "*.jpg" and "*.mpg" should not be
compressed.  Additionally, it also specifies any files matching the wildcard
"*.img" and are larger than 1 Gigabyte should be uncompressed too.  This shows
test operators can be combined with logical expressions.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -action "chmod(o+r)@! perm(o+r)"
If any files within DIRECTORY are not readable by "others", then make them
readable by others in the Squashfs filesystem.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -action "uid(phillip)@! perm(o+r)"
As previous, match on any files which are not readable by "others", but, in
this case change the owner of the file to "phillip" in the Squashfs filesystem.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -action "prune @ type(l) && ! exists"
Delete any symbolic link within DIRECTORY which points outside of DIRECTORY,
i.e. will be unresolvable in the Squashfs filesystem.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -action "exclude @ depth(3)"
Create a Squashfs filesystem containing the two top most levels (contents of
DIRECTORY and immediate sub-directories), and exclude anything at level 3 or
below.
.TP
mksquashfs DIRECTORY IMAGE.SQFS -action "-xattrs-include(^user.) @ type(f)"
Filter the extended attributes but only in regular files (type f), and only
store extended attributes in the user namespace.
.PP
Note: actions should be quoted (as in the above examples), to ensure that they
are passed to Mksquashfs as a single argument, and to ensure that they are not
processed by the shell.
.SH AUTHOR
Written by Phillip Lougher <phillip@squashfs.org.uk>
.SH COPYRIGHT
Copyright \(co 2025 Phillip Lougher <phillip@squashfs.org.uk>
.PP
This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2,
or (at your option) any later version.
.PP
This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.
.SH "SEE ALSO"
unsquashfs(1), sqfstar(1), sqfscat(1)
.PP
The README for the Squashfs\-tools 4.6.1 release, describing the new features can
be read here https://github.com/plougher/squashfs\-tools/blob/master/README\-4.6.1
.PP
The Squashfs\-tools USAGE guide can be read here
https://github.com/plougher/squashfs\-tools/blob/master/USAGE\-4.6
.PP
The ACTIONS\-README file describing how to use the new actions feature can be
read here https://github.com/plougher/squashfs\-tools/blob/master/ACTIONS\-README
